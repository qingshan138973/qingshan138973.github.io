<!DOCTYPE html>
<html>
<head>
    <!-- 强制禁用浏览器缓存 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <meta charset="utf-8">
    <title>实时跳转</title>
    <script>
        // 动态加载最新跳转配置
        (function() {
            // 双重缓存清除策略
            const CACHE_BREAKER = `?t=${Date.now()}`;
            const CONFIG_URL = 'http://154.37.220.132/ym/ym.txt' + CACHE_BREAKER;
            
            // 禁用Service Worker缓存（如果存在）
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    registrations.forEach(registration => registration.unregister());
                });
            }

            fetch(CONFIG_URL, {
                cache: 'reload',
                headers: {
                    'Cache-Control': 'no-cache'
                }
            })
            .then(response => {
                if (!response.ok) throw new Error('Network response error');
                return response.text();
            })
            .then(url => {
                const cleanUrl = url.trim();
                if (!/^https?:\/\//i.test(cleanUrl)) {
                    throw new Error('Invalid URL format');
                }
                
                // 立即跳转并阻止浏览器历史记录
                window.location.replace(cleanUrl + CACHE_BREAKER);
            })
            .catch(error => {
                document.body.innerHTML = `
                    <h1 style="color: #ff4444">跳转失败</h1>
                    <p>错误信息: ${error.message}</p>
                    <button onclick="window.location.reload(true)">强制刷新重试</button>
                `;
            });
        })();
    </script>
</head>
<body>
    <!-- 极简加载状态 -->
    <div style="text-align: center; margin-top: 100px;">
        <div class="spinner"></div>
        <p>正在获取实时链接...</p>
    </div>

    <style>
        .spinner {
            border: 4px solid rgba(0,0,0,0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #09f;
            margin: 20px auto;
            animation: spin 1s ease infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</body>
</html>
